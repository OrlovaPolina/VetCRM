$(document).ready(function(){$(".alert")&&setTimeout(()=>{$(".alert").animate({top:"-100%",opacity:"0"},1500,"linear",function(){$(this).remove()})},1500),$("#reset").click(function(){$("form.filter-form input").each(function(e,a){$(this).val(""),location.href="/manager"})}),$(".image").each(function(){if($(this).attr("value")){let e=$(this).attr("value").split(/\//);e=e[e.length-1];let a=new File([$(this).attr("value")],e,{type:"image/png, image/gif, image/jpeg, image/jpg",lastModified:new Date().getTime()}),l=new DataTransfer;l.items.add(a),$(this).prop("files",l.files)}}),$(document).on("change",".images .image:not(:last-child)",function(){m($(this))}),$(document).on("click","#images > div > i",function(){$("input.image").length>1&&(c($(this).parent()),g())});let t=$("#current-schedule li"),i=[];if(t.each(function(){if(window.location.pathname.indexOf("manager/doctor")!=-1){let e=$(this).data("start"),a=$(this).data("end");i.push({title:e,start:e,end:a})}else if(window.location.pathname.indexOf("/manager/timetable")!=-1){let e=$(this).data("start"),a=$(this).data("end"),l=$(this).data("title"),o="/manager/event/delete/"+$(this).data("url");i.push({title:l,start:e,end:a,url:o})}}),window.location.pathname.indexOf("manager/doctor")!=-1||window.location.pathname.indexOf("/manager/timetable")!=-1){var n=document.getElementById("calendar-curent-schedule"),r=new FullCalendar.Calendar(n,{locale:"ru",contentHeight:"auto",headerToolbar:{left:"prev,next today",right:"dayGridMonth,timeGridWeek,timeGridDay"},initialDate:new Date,eventClassNames:"time-td",navLinks:!0,selectable:!0,selectMirror:!0,select:function(e){var a=prompt("Расписание:");a&&r.addEvent({title:e.title,start:e.start,end:e.end,allDay:e.allDay}),r.unselect()},editable:!0,dayMaxEventRows:6,events:i,eventClick:function(e){e.jsEvent.preventDefault(),e.event.url&&confirm("Вы уверены, что хотите удалить запись?")===!0&&window.open(e.event.url)}});r.render()}});function m(t){let i=parseInt(t.prop("name").split(/(\[)|(\])/)[3]);d(i);let n=$("input.image").length;n<2?s(0):i+1==n&&s(i)}function s(t){t=t+1;let i='<div class="input-group"><input type="file" name="images['+t+']" class="image" aaccept="image/png, image/gif, image/jpeg, image/jpg"><img src="preview-image.png" id="image-'+t+'" alt="Preview"><i class="bi bi-x-circle-fill"></i></div>';$("#images").append(i)}function c(t){t.remove()}function d(t){t=t;const[i]=$('input.image[name="images['+t+']"]').prop("files");i&&$("img#image-"+t).prop("src",URL.createObjectURL(i))}function g(){$(".images>.input-group").each(function(t){$(this).children("input").attr("name","images["+t+"]"),$(this).children("img").attr("id","image-"+t)})}
